-- HiveQLs to write data from a table to a partition

-- Create table empDetails
CREATE TABLE empDetails (id INT, name STRING, deptid INT)
  ROW FORMAT DELIMITED
    FIELDS TERMINATED BY ',';

-- Populate the table with data in HDFS
LOAD DATA INPATH '/cloudwick/hive/empDetails'
  INTO TABLE empDetails;

-- Create Table empPartitioned for storing data in Partitioned format
CREATE TABLE empPartitioned (id INT, name STRING)
  PARTITIONED BY (deptid INT)
  ROW FORMAT DELIMITED
    FIELDS TERMINATED BY ',';

-- Insert data from unpartitioned table to partitioned table
INSERT OVERWRITE TABLE empPartitioned
  PARTITION(deptid)
  SELECT id,name,deptid
    FROM empDetails;
