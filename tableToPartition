-- HiveQLs to write data from a table to a partition

-- Create table empDetails
CREATE TABLE empDetails (id INT, name STRING, deptid INT)
  ROW FORMAT DELIMITED
    FIELDS TERMINATED BY ',';

-- Populate the table with data in HDFS
LOAD DATA INPATH '/cloudwick/hive/empDetails'
  INTO TABLE empDetails;

-- Create Table empPartitioned for storing data in Partitioned format
CREATE TABLE empPartitioned (id INT, name STRING)
  PARTITIONED BY (deptid INT)
  ROW FORMAT DELIMITED
    FIELDS TERMINATED BY ',';

-- Insert data from unpartitioned table to partitioned table
INSERT OVERWRITE TABLE empPartitioned
  PARTITION(deptid=10)
  SELECT id,name
    FROM empDetails
    WHERE deptid = 10;

ERROR/ ISSUE:
Query ID = root_20150628130021_d107e711-357f-4247-a47e-762c3e6ce952
Total jobs = 3
Launching Job 1 out of 3
Number of reduce tasks is set to 0 since there's no reduce operator
